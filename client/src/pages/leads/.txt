
import {
  Box,
  Button,
  Typography,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  IconButton,
  Select,
  MenuItem,
  InputBase,
  Paper,
  Pagination,
  Grid,
  useMediaQuery,
  Modal,
} from "@mui/material";
import { useRef, useState } from "react";
import HeaderView from "../../template/HeaderView";
// import LeadPreviewModal from "../../components/lead-preview-modal";
import LeadsModal from "../../components/leads-modal";
import { Edit, Search, Visibility } from "@mui/icons-material";
import { useTheme } from "@mui/system";
import LeadPreviewFormModal from "../../components/lead-preview-modal/LeadPreviewModal";
// import UserLeadPreviewFormModal from "../../components/lead-preview-modal/LeadPreviewModal";

const Lead = () => {
  const fileInputRef = useRef<HTMLInputElement | null>(null);
  const [open, setOpen] = useState(false);
  const [isLeadsModalOpen, setIsLeadsModalOpen] = useState(false);
  const [fileSelected, setFileSelected] = useState(false); // State to manage file selection

  const theme = useTheme();
  const isMobile = useMediaQuery(theme.breakpoints.down("sm")); // Responsiveness

  const handleClickOpen = () => {
    setOpen(true);
  };



  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    console.log("file data", file);
  };

  const handleEdit = (row: any) => {
    setOpen(true);
    setFileSelected(row);
  };

  const rows = [
    {
      name: "John Doe",
      contact: "(+91)9774432345",
      email: "johndoe@gmail.com",
      channel: "Instagram",
      counselor: "Not Assigned",
    },
    {
      name: "Sarah Haw",
      contact: "(+91)9774432345",
      email: "johndoe@gmail.com",
      channel: "Youtube",
      counselor: "Not Assigned",
    },
    {
      name: "Tyson Tan",
      contact: "(+91)9774432345",
      email: "johndoe@gmail.com",
      channel: "Facebook",
      counselor: "Not Assigned",
    },
    {
      name: "Robert Shell",
      contact: "(+91)9774432345",
      email: "johndoe@gmail.com",
      channel: "Youtube",
      counselor: "Not Assigned",
    },
  ];

  const handleOpen = () => setOpen(true);
  const handleClose = () => setOpen(false);

  return (<>
    <Box sx={{ backgroundColor: "#F9FAFB", height: "100vh" }}>
      <HeaderView />

      <Box
        sx={{
          padding: isMobile ? "20px" : "40px",
          maxWidth: "1200px",
          margin: "auto",
        }}
      >
        <Typography
          variant="h4"
          fontWeight="bold"
          sx={{ mb: 3, color: "#111827" }}
        >
          Enrolled Leads
        </Typography>

        <Grid
          container
          spacing={2}
          sx={{
            justifyContent: "space-between",
            alignItems: "center",
            mb: 4,
          }}
        >
          <Grid item xs={12} sm={4} md={3}>
            <Select
              fullWidth
              defaultValue="Enrolled"
              sx={{
                height: "45px",
                backgroundColor: "#FFFFFF",
                borderColor: "#D1D5DB",
                color: "#374151",
              }}
            >
              <MenuItem value="Enrolled">Enrolled</MenuItem>
              <MenuItem value="All Leads">All Leads</MenuItem>
            </Select>
          </Grid>
          <Grid item xs={12} sm={4} md={3}>
            <Button
              fullWidth
              variant="contained"
              sx={{
                height: "45px",
                backgroundColor: "#2563EB",
                color: "#FFFFFF",
                textTransform: "none",
              }}
              onClick={() => setIsLeadsModalOpen(true)}
            >
              + Create Lead
            </Button>
          </Grid>
          <Grid item xs={12} sm={4} md={3}>
            <Button
              fullWidth
              variant="outlined"
              sx={{
                height: "45px",
                borderColor: "#2563EB",
                color: "#2563EB",
                textTransform: "none",
              }}
              onClick={() => fileInputRef.current?.click()}
            >
              Import from Excel
              <input
                type="file"
                ref={fileInputRef}
                style={{ display: "none" }}
                onChange={handleFileChange}
              />
            </Button>
          </Grid>
        </Grid>

        <Box
          sx={{
            mb: 3,
            display: "flex",
            justifyContent: "flex-start",
          }}
        >
          <InputBase
            placeholder="Search Lead"
            sx={{
              border: "1px solid #D1D5DB",
              borderRadius: "8px",
              padding: "10px 12px",
              width: "100%",
              maxWidth: "400px",
              bgcolor: "#FFFFFF",
            }}
            startAdornment={<Search sx={{ mr: 1, color: "#9CA3AF" }} />}
          />
        </Box>

        <TableContainer component={Paper} sx={{ borderRadius: "8px" }}>
          <Table sx={{ minWidth: 650 }}>
            <TableHead>
              <TableRow sx={{ backgroundColor: "#F3F4F6" }}>
                <TableCell sx={{ color: "#6B7280", fontWeight: "bold" }}>
                  Full Name
                </TableCell>
                <TableCell sx={{ color: "#6B7280", fontWeight: "bold" }}>
                  Contact Number
                </TableCell>
                <TableCell sx={{ color: "#6B7280", fontWeight: "bold" }}>
                  Email Id
                </TableCell>
                <TableCell sx={{ color: "#6B7280", fontWeight: "bold" }}>
                  Manage Status
                </TableCell>
                <TableCell sx={{ color: "#6B7280", fontWeight: "bold" }}>
                  Channel
                </TableCell>
                <TableCell sx={{ color: "#6B7280", fontWeight: "bold" }}>
                  Counselor Name
                </TableCell>
                <TableCell sx={{ color: "#6B7280", fontWeight: "bold" }}>
                  Actions
                </TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {rows.map((row, index) => (
                <TableRow key={index}>
                  <TableCell>{row.name}</TableCell>
                  <TableCell>{row.contact}</TableCell>
                  <TableCell>{row.email}</TableCell>
                  <TableCell>Enrolled</TableCell>
                  <TableCell>{row.channel}</TableCell>
                  <TableCell>
                    <Select defaultValue={row.counselor}>
                      <MenuItem value="Not Assigned">Not Assigned</MenuItem>
                      <MenuItem value="Peter">Peter</MenuItem>
                    </Select>
                  </TableCell>
                  <TableCell>
                    <IconButton onClick={() => handleEdit(row)}>
                      <Edit sx={{ color: "#2563EB" }} />
                    </IconButton>
                    <IconButton>
                      <Visibility sx={{ color: "#4B5563" }} />
                    </IconButton>
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        {/* Pagination */}
        <Box sx={{ mt: 3, display: "flex", justifyContent: "center" }}>
          <Pagination count={5} variant="outlined" color="primary" />
        </Box>
      </Box>

      {/* Modals */}
      {/* <LeadPreviewModal
        open={open}
        handleClose={handleClose}
        handleOpen={handleClickOpen}
        data={fileSelected}
      /> */}

    </Box>

    {/*  newly changed */}

    <Modal open={open} onClose={handleClose} aria-labelledby="modal-title">
      <Box
        sx={{
          position: 'absolute',
          top: '50%',
          left: '50%',
          transform: 'translate(-50%, -50%)',
          width: { xs: '90%', sm: '80%', md: '70%', lg: 800 }, // Responsive width
          bgcolor: 'background.paper',
          boxShadow: 24,
          p: { xs: 2, sm: 3, md: 4 }, // Responsive padding
          borderRadius: 2,
        }}
      >
        <LeadPreviewFormModal onClose={handleClose} />
      </Box>
    </Modal>




  </>);
};

export default Lead;
